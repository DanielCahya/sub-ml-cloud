# Cancer Skin Prediction API

This is a Node.js API for predicting skin cancer using a pre-trained machine learning model. The API handles image uploads, predicts the presence of skin cancer, and returns the result as a JSON response.

## Prerequisites

Before setting up the project, ensure the following tools are installed on your system:

- **Node.js** (v14 or higher)
- **npm** (Node Package Manager)
- **Google Cloud SDK** (for deploying and managing resources on Google Cloud)
- **Git**

---

## Installation

Follow these steps to set up the project on your local machine:

### Step 1: Clone the Repository

```bash
# Clone the repository
git clone <repository-url>

# Navigate to the project directory
cd CancerSkinPrediction
```

### Step 2: Install Node.js Dependencies
Ensure npm is installed, then run:

```bash
npm install
```

### Step 3: Configure the .env File
Copy the example environment file:

```bash
cp .env.example .env
```

- Open the `.env` file and update the following settings:

`MODEL_URL:` URL for the machine learning model stored in Google Cloud Storage.
`PROJECT_ID:` Your Google Cloud project ID.
`FIRESTORE_COLLECTION:` Firestore collection name for saving predictions.

### Step 4: Create a Google Cloud Storage Bucket
1. Open Google Cloud Console.
2. Navigate to `Cloud Storage`.
3. Click `Create Bucket`.
4. Follow the prompts to set up your bucket. Ensure the bucket name matches the one used in `MODEL_URL`

### Step 5: Upload the Machine Learning Model
After creating your bucket, upload the model.json file (and any other necessary model files) to the bucket. You can do this via the Google Cloud Console or using the gsutil command.

Example using gsutil:

```bash
gsutil cp path/to/your/model.json gs://model-bucket-ML/
```

### Step 6: Run the Application
For local development, use the following command:

```bash
npm start
```

By default, the application will be available at http://127.0.0.1:3000

## API Endpoints
## POST /predict
- Description: This endpoint accepts an image file, runs the model prediction, and returns the result.
- Request:
    - Content-Type: multipart/form-data
    - File: Image file (e.g., .jpg, .png)
- Response:
    - Success (Cancer):
    
    ```json
    {
        "result": "Cancer",
        "message": "Please consult a doctor.",
        "timestamp": "2024-12-28T12:34:56Z"
    }
    ```
    - Success (Non-Cancer):

    ```json
    {
        "result": "Non-cancer",
        "message": "Cancer is not detected."
    }
    ```
    - Error (Payload size too large):

    ```json
    {
        "error": "Payload size exceeds the allowed limit."
    }
    ```
    - Error (Prediction failure):

    ```json
    {
        "error": "Prediction failed. Please try again later."
    }
    ```

## Deployment
To deploy the application, follow these steps:

    1. Deploy to Google Cloud:
        - Use the `gcloud` command to deploy the API to Google Cloud App Engine or Cloud Run, depending on your architecture.

    2. Ensure Firestore is set up:
        - Go to Firestore and create a Firestore database in Native mode.
        - Make sure the collection name (`predictions`) is created or will be auto-generated by your API.

